<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predavanja & AI - ŠtudijHub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4a90e2;
            --bg-dark: #0f172a;
            --card-bg: rgba(255, 255, 255, 0.07);
            --text-light: #f8fafc;
            --accent: #10b981;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            background-image: radial-gradient(circle at top right, #1e293b, #0f172a);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        nav {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem 5%; background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
            padding: 20px;
            flex-grow: 1;
        }

        /* --- AI Sekcija --- */
        .ai-section {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        #ai-output {
            flex-grow: 1;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            overflow-y: auto;
            font-size: 0.9rem;
            min-height: 300px;
            border: 1px solid rgba(255,255,255,0.05);
        }

        /* DODANO: Progress Bar stil */
        #progress-container {
            display: none;
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        #progress-bar {
            width: 0%;
            height: 100%;
            background: var(--primary-color);
            transition: width 0.2s ease;
        }

        .status-msg { font-size: 0.75rem; color: var(--accent); margin-bottom: 5px; }

        .ai-input-area { display: flex; gap: 10px; }
        input { flex-grow: 1; padding: 10px; border-radius: 5px; border: none; background: #334155; color: white; }

        /* --- Flashcards --- */
        .flashcard-container { perspective: 1000px; margin-top: 20px; }
        .flashcard {
            width: 100%; height: 200px; transition: transform 0.6s;
            transform-style: preserve-3d; cursor: pointer; position: relative;
        }
        .flashcard.flipped { transform: rotateY(180deg); }
        .card-face {
            position: absolute; width: 100%; height: 100%;
            backface-visibility: hidden;
            display: flex; align-items: center; justify-content: center;
            padding: 20px; border-radius: 15px; text-align: center;
            font-weight: bold; font-size: 1.2rem;
        }
        .card-front { background: var(--primary-color); color: white; }
        .card-back { background: var(--accent); color: white; transform: rotateY(180deg); }

        /* --- Risalna deska --- */
        #board-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: none; flex-direction: column; align-items: center; justify-content: center;
            z-index: 2000;
        }
        #canvas { background: white; border-radius: 10px; cursor: crosshair; box-shadow: 0 0 20px rgba(0,0,0,0.5); }

        /* --- Motivacija --- */
        #quote-box {
            position: fixed; bottom: 20px; right: 20px;
            background: linear-gradient(135deg, #4a90e2, #6366f1);
            padding: 15px; border-radius: 12px; max-width: 250px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            font-style: italic; font-size: 0.85rem;
            animation: slideIn 0.5s ease;
            z-index: 10;
        }

        @keyframes slideIn { from { transform: translateX(110%); } to { transform: translateX(0); } }
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; background: var(--primary-color); color: white; transition: 0.3s; }
        .btn:disabled { background: #475569; cursor: not-allowed; }
        .btn:hover:not(:disabled) { filter: brightness(1.1); }
    </style>
</head>
<body>

    <nav>
        <a href="index.html" style="color: white; text-decoration: none;"><i class="fas fa-arrow-left"></i> Domov</a>
        <div>
            <button class="btn" onclick="toggleBoard()"><i class="fas fa-chalkboard"></i> Odpri tablo</button>
        </div>
    </nav>

    <div class="main-layout">
        <div class="content">
            <section class="ai-section">
                <h3><i class="fas fa-robot"></i> Študijski Asistent (Local AI)</h3>
                <div id="ai-status" class="status-msg">Pripravljen.</div>
                
                <div id="progress-container">
                    <div id="progress-bar"></div>
                </div>

                <div id="ai-output">Živijo! Sem tvoj lokalni asistent. Ob prvem vprašanju bom prenesel model v tvoj brskalnik (cca 150MB).</div>
                <div class="ai-input-area">
                    <input type="text" id="ai-input" placeholder="Vprašaj karkoli...">
                    <button class="btn" id="ai-btn" onclick="askAI()">Vprašaj</button>
                </div>
            </section>

            <h3 style="margin-top: 30px;">Flashcards za ponavljanje</h3>
            <div class="flashcard-container" onclick="this.querySelector('.flashcard').classList.toggle('flipped')">
                <div class="flashcard">
                    <div class="card-face card-front" id="flash-q">Pritisni za začetek</div>
                    <div class="card-face card-back" id="flash-a">Pritisni spodaj za naslednjo kartico</div>
                </div>
            </div>
            <button class="btn" style="margin-top: 10px;" onclick="generateFlashcard()">Generiraj novo vprašanje</button>
        </div>

        <div class="sidebar">
            <div class="ai-section">
                <h3>Moja Predavanja</h3>
                <ul style="list-style: none; margin-top: 10px;">
                    <li style="padding: 10px; border-bottom: 1px solid #334155;"><i class="fas fa-microchip"></i> Informatika</li>
                    <li style="padding: 10px; border-bottom: 1px solid #334155;"><i class="fas fa-square-root-alt"></i> Matematika</li>
                    <li style="padding: 10px; border-bottom: 1px solid #334155;"><i class="fas fa-dna"></i> Biologija</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="board-overlay">
        <h2 style="margin-bottom: 10px; color: white;">Interaktivna tabla</h2>
        <canvas id="canvas" width="800" height="500"></canvas>
        <div style="margin-top: 10px;">
            <button class="btn" style="background: #ef4444;" onclick="clearCanvas()">Izbriši</button>
            <button class="btn" onclick="toggleBoard()">Zapri</button>
        </div>
    </div>

    <div id="quote-box">
        <i class="fas fa-quote-left"></i>
        <span id="quote-text">Vse je mogoče, če se le potrudiš.</span>
    </div>

    <script type="module">
    import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.1';

    let generator = null;
    const status = document.getElementById('ai-status');
    const output = document.getElementById('ai-output');
    const btn = document.getElementById('ai-btn');
    const progContainer = document.getElementById('progress-container');
    const progBar = document.getElementById('progress-bar');

    window.askAI = async () => {
        const inputField = document.getElementById('ai-input');
        const text = inputField.value.trim();
        if (!text) return;

        if (!generator) {
            progContainer.style.display = 'block';
            status.innerText = "Nalagam pametnejši model (Flan-T5)...";
            btn.disabled = true;

            try {
                // Flan-T5 je boljši za vprašanja/odgovore in bolje prenaša slovenščino
                generator = await pipeline('text2text-generation', 'Xenova/flan-t5-small', {
                    progress_callback: (data) => {
                        if (data.status === 'progress') {
                            progBar.style.width = data.progress + '%';
                        }
                        if (data.status === 'ready') {
                            status.innerText = "Asistent pripravljen.";
                            setTimeout(() => { progContainer.style.display = 'none'; }, 1000);
                        }
                    }
                });
                btn.disabled = false;
            } catch (err) {
                status.innerText = "Napaka pri povezavi.";
                console.error(err);
            }
        }

        output.innerHTML += `<div style="margin-top:10px; color:#4a90e2;"><b>Ti:</b> ${text}</div>`;
        status.innerText = "Analiziram snov...";
        
        // Trik: Modelu povemo, naj odgovori v slovenščini (če zmore), 
        // sicer pa Flan-T5 vsaj ne bo metal "I am an AI model" napak tako pogosto.
        const response = await generator(text, { 
            max_new_tokens: 100,
            temperature: 0.5,
            top_k: 50
        });
        
        let aiRes = response[0].generated_text;
        
        output.innerHTML += `<div style="margin-top:5px; padding-left:10px; border-left: 2px solid var(--accent);"><b>Asistent:</b> ${aiRes}</div>`;
        output.scrollTop = output.scrollHeight;
        status.innerText = "Pripravljen.";
        inputField.value = '';
    };
</script>


    <script>
        // --- Motivacija ---
        const quotes = [
            "Uspeh je vsota majhnih naporov, ki se ponavljajo dan za dnem.",
            "Ne čakaj na priložnost. Ustvari jo.",
            "Znanje je moč.",
            "Vse je težko, preden postane lahko.",
            "Tvoj trud danes je tvoj uspeh jutri."
        ];
        setInterval(() => {
            document.getElementById('quote-text').innerText = quotes[Math.floor(Math.random() * quotes.length)];
        }, 12000);

        // --- Tabla ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;

        canvas.addEventListener('mousedown', () => drawing = true);
        canvas.addEventListener('mouseup', () => { drawing = false; ctx.beginPath(); });
        canvas.addEventListener('mousemove', draw);

        function draw(e) {
            if (!drawing) return;
            const rect = canvas.getBoundingClientRect();
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            ctx.strokeStyle = '#2d3436';
            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        }

        function toggleBoard() {
            const board = document.getElementById('board-overlay');
            board.style.display = board.style.display === 'flex' ? 'none' : 'flex';
        }
        function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

        // --- Flashcards ---
        const flashData = [
            { q: "Kaj je osmoza?", a: "Prehajanje topila skozi polprepustno opno." },
            { q: "Kdo je napisal Krst pri Savici?", a: "France Prešeren." },
            { q: "Kaj je algoritem?", a: "Natančen opis postopka za rešitev določene naloge." },
            { q: "Formula za silo?", a: "F = m * a (Sila = masa * pospešek)" }
        ];

        function generateFlashcard() {
            const rand = flashData[Math.floor(Math.random() * flashData.length)];
            const card = document.querySelector('.flashcard');
            card.classList.remove('flipped');
            setTimeout(() => {
                document.getElementById('flash-q').innerText = rand.q;
                document.getElementById('flash-a').innerText = rand.a;
            }, 150);
        }
    </script>
</body>
</html>

